--6) ¿Cuáles son los 5 clientes que han transferido menos dinero y cuánto?
SELECT b.id_cliente_origen, sum(b.cuantia) as total_transferido
FROM public."Balance" b JOIN public."Detalle_transacciones" d 
ON (b.t_id = d.t_id)
WHERE d.tipo = 'TRANSFER' and b.cuantia <> 0
GROUP BY id_cliente_origen
ORDER BY total_transferido asc
limit 5 

--7)¿Cuáles son los 10 clientes que han recibido más dinero y cuánto?
SELECT b.id_cliente_destino, round(CAST(SUM(b.cuantia) as numeric), 2) as total_transferido
FROM public."Balance" b JOIN public."Detalle_transacciones" d 
ON (b.t_id = d.t_id)
WHERE d.tipo = 'TRANSFER' 
GROUP BY id_cliente_destino
ORDER BY total_transferido desc
limit 10

--8)¿Cuáles son los 3 clientes con mejor balance a lo largo del mes (aquellos que al restarle al dinero recibido el dinero enviado se quedan con un mejor resultado) y cuál ha sido su balance?






--9)¿Cuáles son los 3 clientes con peor balance a lo largo de todo el mes y cuál ha sido?






--10)¿Cuántas transacciones fraudulentas se han producido?
